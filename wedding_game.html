<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ğŸ’ WEDDING BATTLE ğŸ’–</title>
<style>
  body { background: linear-gradient(#c2e9fb,#ffffff); font-family: "Comic Sans MS", sans-serif; text-align:center; margin:0; padding:0; }

  /* ì‹œì‘ í™”ë©´ */
  #startScreen { width:100%; height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; }
  #startScreen h1 { font-size:50px; margin-bottom:40px; }
  #startButton { padding:20px 40px; font-size:24px; border-radius:15px; border:none; background-color:#ff99cc; color:white; cursor:pointer; }
  #startButton:hover { background-color:#ff66aa; }

/* ë°°í‹€ í™”ë©´ */
#battleScreen { display:none; }

/* ë°°í‹€ í•„ë“œ */
#battlefield {
  position: relative;
  width: 90vw;       /* í™”ë©´ í­ì˜ 90% */
  max-width: 800px;  /* í° í™”ë©´ì—ì„œëŠ” ìµœëŒ€ 800px */
  height: 30vw;      /* í­ì— ë¹„ë¡€í•´ì„œ ë†’ì´ ì¡°ì • */
  max-height: 250px; /* ìµœëŒ€ ë†’ì´ */
  margin: 5vh auto;  /* ìœ„ì•„ë˜ ì—¬ë°± */
  background: #e6f7ff;
  border: 3px solid #555;
  border-radius: 15px;
}

/* ìºë¦­í„° */
.character {
  position: absolute;
  width: 25%;        /* í™”ë©´ ë¹„ìœ¨ë¡œ í¬ê¸° ì¡°ì • */
  bottom: 0;
}
#groom { left: 5%; }   /* í™”ë©´ ì™¼ìª½ 5% ìœ„ì¹˜ */
#bride { right: 5%; }  /* í™”ë©´ ì˜¤ë¥¸ìª½ 5% ìœ„ì¹˜ */

/* ì²´ë ¥ë°” */
.hpbar {
  width: 40vw;         /* í™”ë©´ ë¹„ìœ¨ */
  max-width: 200px;    /* ìµœëŒ€ í¬ê¸° ìœ ì§€ */
  height: 20px;
  border: 2px solid #333;
  border-radius: 10px;
  background: #fff;
  margin: 10px auto;
  overflow: hidden;
}

/* ë²„íŠ¼ */
button {
  margin: 5px;
  padding: 15px 25px;  /* ëª¨ë°”ì¼ì—ì„œ í„°ì¹˜í•˜ê¸° í¸í•˜ê²Œ */
  font-size: 18px;
  border-radius: 8px;
  border: none;
  background-color: #ffd6e7;
  cursor: pointer;
}
button:hover { background-color: #ffc0da; }

/* ë¡œê·¸ */
#log {
  margin-top: 20px;
  font-size: 18px;   /* ëª¨ë°”ì¼ì—ì„œëŠ” ì•½ê°„ ì‘ê²Œ */
  min-height: 40px;
}
  /* í¬ì˜¹ í•˜íŠ¸ */
  .heart-effect { position:absolute; font-size:20px; pointer-events:none; animation:floatUp 1.8s ease-out forwards; }
  @keyframes floatUp {
    0% { transform:translateY(0) scale(0.5); opacity:0.8; }
    50% { transform:translateY(-50px) scale(1.2); opacity:1; }
    100% { transform:translateY(-120px) scale(0.8); opacity:0; }
  }

  /* ì§ì§„ í•˜íŠ¸ */
 .heart-fly {
  position:absolute;
  font-size:30px;
  pointer-events:none;
  animation:flyToTarget 1s linear forwards;
}

@keyframes flyToTarget {
  0% { transform: translate(0px, 0px) scale(0.5); opacity:0.8; }
  100% { transform: translate(var(--dx, 0px), var(--dy, 0px)) scale(1); opacity:0; }
}
</style>
</head>
<body>

<!-- ì‹œì‘ í™”ë©´ -->
<div id="startScreen">
  <h1>ğŸ’ BATTLE TO THE WEDDING ğŸ’–</h1>
  <button id="startButton">ê²Œì„ ì‹œì‘</button>
</div>

<!-- ë°°í‹€ í™”ë©´ -->
<div id="battleScreen">
  <div id="battlefield">
    <img id="groom" class="character" src="groom.png" alt="ë³‘ì§" />
    <img id="bride" class="character" src="bride.png" alt="ê³ ì€" />
  </div>

  <div>
    <h3>ê³ ì€ì˜ ì‚¬ë‘ì§€ìˆ˜</h3>
    <div class="hpbar"><div id="goeunHP" class="hp" style="width:0%;"></div></div>

    <h3>ë³‘ì§ì˜ ì‚¬ë‘ì§€ìˆ˜</h3>
    <div class="hpbar"><div id="byungjikHP" class="hp" style="width:0%;"></div></div>
  </div>

  <div id="buttons"></div>
  <h2 id="turnLabel">â¤ï¸ ê³ ì€ì˜ í„´ â¤ï¸</h2>
  <div id="log"></div>
</div>

<!-- ë°°ê²½ìŒ -->
<audio id="bgm" src="love_bgm.mp3" loop></audio>

<script>
let goEunHP=0, byungJikHP=0, turn="goeun";
const log=document.getElementById("log");
const turnLabel=document.getElementById("turnLabel");
const bgm=document.getElementById("bgm");
bgm.volume=0.5;

// ì‹œì‘ ë²„íŠ¼
document.getElementById("startButton").addEventListener("click",()=>{
  document.getElementById("startScreen").style.display="none";
  document.getElementById("battleScreen").style.display="block";
  updateHP(); showButtons();
  bgm.play().catch(()=>console.log("ìë™ ì¬ìƒ ì°¨ë‹¨ë¨"));
});

// í¬ì˜¹ í•˜íŠ¸
function spawnHearts(x,y,count=7,color="#ff69b4"){
  for(let i=0;i<count;i++){
    const heart=document.createElement("div");
    heart.className="heart-effect"; heart.innerText="ğŸ’–"; heart.style.color=color;
    heart.style.left=(x+Math.random()*50-25)+"px";
    heart.style.top=(y+Math.random()*50-25)+"px";
    document.getElementById("battlefield").appendChild(heart);
    setTimeout(()=>heart.remove(),1800);
  }
}

// ì§ì§„ í•˜íŠ¸
function flyHeart(fromEl, toEl, color="#ff69b4"){
  const bf = document.getElementById("battlefield");
  const bfRect = bf.getBoundingClientRect();
  const fromRect = fromEl.getBoundingClientRect();
  const toRect = toEl.getBoundingClientRect();

  const heart = document.createElement("div");
  heart.className = "heart-fly";
  heart.innerText = color === "#00ccff" ? "ğŸ’–" : "ğŸ’™";
  heart.style.color = color;

  // ì‹œì‘ ì¢Œí‘œ
  const startX = fromRect.left - bfRect.left + fromRect.width/2;
  const startY = fromRect.top - bfRect.top + fromRect.height/2;

  // ë ì¢Œí‘œ
  const endX = toRect.left - bfRect.left + toRect.width/2;
  const endY = toRect.top - bfRect.top + toRect.height/2;

  heart.style.left = startX + "px";
  heart.style.top = startY + "px";

  // --dx, --dyëŠ” transformì—ì„œ ì‚¬ìš©
  heart.style.setProperty("--dx", (endX - startX) + "px");
  heart.style.setProperty("--dy", (endY - startY) + "px");

  bf.appendChild(heart);

  // ì• ë‹ˆë©”ì´ì…˜ ëë‚˜ë©´ ì œê±°
  heart.addEventListener("animationend", ()=>heart.remove());
}

function updateHP(){
  document.getElementById("goeunHP").style.width=goEunHP+"%";
  document.getElementById("byungjikHP").style.width=byungJikHP+"%";
}

function showButtons(){
  const container=document.getElementById("buttons"); container.innerHTML="";
  const skills=turn==="goeun"?goEunSkills:byungJikSkills;
  Object.keys(skills).forEach(skill=>{
    const btn=document.createElement("button"); btn.innerText=skill;
    btn.onclick=()=>useSkill(skill); container.appendChild(btn);
  });
}

function useSkill(skill){
  const actor=turn==="goeun"?"ê³ ì€":"ë³‘ì§";
  const skillSet=turn==="goeun"?goEunSkills:byungJikSkills;
  const groomEl=document.getElementById("groom");
  const brideEl=document.getElementById("bride");

  skillSet[skill]();

  if(goEunHP>100) goEunHP=100;
  if(byungJikHP>100) byungJikHP=100;
  if(goEunHP<0) goEunHP=0;
  if(byungJikHP<0) byungJikHP=0;

  updateHP();
  log.innerText=`${actor}ì´(ê°€) '${skill}' ìŠ¤í‚¬ì„ ì¼ë‹¤! ğŸ’«`;

  // í¬ì˜¹ í•˜íŠ¸ 7ê°œ ì–‘ìª½
  if(skill==="í¬ì˜¹í•˜ê¸°"){
    if(turn==="goeun"){ spawnHearts(200,50,7,"#ff69b4"); spawnHearts(500,50,7,"#ff69b4"); }
    else { spawnHearts(500,50,7,"#00ccff"); spawnHearts(200,50,7,"#00ccff"); }
  } else { // ì§ì§„ í•˜íŠ¸ 1ê°œ
    if(turn==="goeun") flyHeart(document.getElementById("groom"), document.getElementById("bride"), "#ff69b4");  // ê³ ì€ â†’ ë³‘ì§
    else flyHeart(document.getElementById("bride"), document.getElementById("groom"), "#00ccff");  // ë³‘ì§ â†’ ê³ ì€
  }

  // ì—”ë”©
  if(goEunHP>=100 && byungJikHP>=100){
    log.innerHTML=`ğŸ’– êµ¿ ì—”ë”© ğŸ’– í–‰ë³µí•˜ê²Œ ì˜¤ë˜ì˜¤ë˜ ì‚´ì•˜ìŠµë‹ˆë‹¤~<br>2ì›” 7ì¼ì— ë§Œë‚˜ìš”!`;
    document.getElementById("buttons").innerHTML="";
    turnLabel.innerText=""; return;
  }

  // í„´ ì „í™˜
  turn=turn==="goeun"?"byungjik":"goeun";
  turnLabel.innerText=turn==="goeun"?"â¤ï¸ ê³ ì€ì˜ í„´ â¤ï¸":"ğŸ’™ ë³‘ì§ì˜ í„´ ğŸ’™";
  showButtons();
}

// ìŠ¤í‚¬ ì •ì˜
const goEunSkills={
  "ì†ìˆ˜ê±´ ê±´ë„¤ê¸°":()=>{ byungJikHP+=20; },
  "ì˜ì–‘ì œ ì£¼ê¸°":()=>{ byungJikHP+=30; goEunHP-=10; },
  "ì¿ í‚¤ ë§Œë“¤ì–´ì£¼ê¸°":()=>{ byungJikHP+=25; },
  "í¬ì˜¹í•˜ê¸°":()=>{ goEunHP+=15; byungJikHP+=15; }
};
const byungJikSkills={
  "ë°ì´íŠ¸ ì‹ ì²­í•˜ê¸°":()=>{ goEunHP+=20; },
  "ì»¤í”¼ ì‚¬ì£¼ê¸°":()=>{ goEunHP+=25; },
  "ì„ ë¬¼ ì¤€ë¹„í•˜ê¸°":()=>{ goEunHP+=30; byungJikHP-=10; },
  "í¬ì˜¹í•˜ê¸°":()=>{ goEunHP+=15; byungJikHP+=15; }
};
</script>
</body>
</html>
